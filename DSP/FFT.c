#include "stdlib.h"
#include "math.h"
#include "FFT.h"
#include <stdio.h>
#define __EXTERN_W__

//#ifdef __EXTERN_W__
//========Paste the definitions for W here========
//const Complex FFT_W[15] = 
//{
//	{0.98078528040323,-0.195090322016128},
//	{0.923879532511287,-0.38268343236509},
//	{0.831469612302545,-0.555570233019602},
//	{0.707106781186547,-0.707106781186547},
//	{0.555570233019602,-0.831469612302545},
//	{0.38268343236509,-0.923879532511287},
//	{0.195090322016128,-0.98078528040323},
//	{5.55111512312578E-17,-1},
//	{-0.195090322016128,-0.98078528040323},
//	{-0.38268343236509,-0.923879532511287},
//	{-0.555570233019602,-0.831469612302545},
//	{-0.707106781186547,-0.707106781186547},
//	{-0.831469612302545,-0.555570233019602},
//	{-0.923879532511286,-0.38268343236509},
//	{-0.98078528040323,-0.195090322016128}
//};
const Complex FFT_W[511] = 
{
	{ 0.9999811753 , -0.0061358849	},
	{ 0.9999247018 , -0.0122715385	},
	{ 0.9998305818 , -0.0184067301	},
	{ 0.9996988187 , -0.0245412287	},
	{ 0.9995294175 , -0.0306748034	},
	{ 0.9993223846 , -0.0368072232	},
	{ 0.9990777277 , -0.0429382571	},
	{ 0.9987954562 , -0.0490676745	},
	{ 0.9984755806 , -0.0551952446	},
	{ 0.9981181129 , -0.0613207365	},
	{ 0.9977230666 , -0.0674439198	},
	{ 0.9972904567 , -0.0735645638	},
	{ 0.9968202993 , -0.0796824382	},
	{ 0.9963126122 , -0.0857973126	},
	{ 0.9957674144 , -0.0919089567	},
	{ 0.9951847267 , -0.0980171405	},
	{ 0.9945645707 , -0.1041216341	},
	{ 0.9939069700 , -0.1102222075	},
	{ 0.9932119492 , -0.1163186311	},
	{ 0.9924795346 , -0.1224106754	},
	{ 0.9917097536 , -0.1284981110	},
	{ 0.9909026354 , -0.1345807087	},
	{ 0.9900582102 , -0.1406582396	},
	{ 0.9891765099 , -0.1467304747	},
	{ 0.9882575677 , -0.1527971855	},
	{ 0.9873014181 , -0.1588581436	},
	{ 0.9863080972 , -0.1649131207	},
	{ 0.9852776424 , -0.1709618890	},
	{ 0.9842100923 , -0.1770042206	},
	{ 0.9831054874 , -0.1830398882	},
	{ 0.9819638691 , -0.1890686644	},
	{ 0.9807852804 , -0.1950903222	},
	{ 0.9795697656 , -0.2011046351	},
	{ 0.9783173707 , -0.2071113764	},
	{ 0.9770281426 , -0.2131103201	},
	{ 0.9757021300 , -0.2191012404	},
	{ 0.9743393827 , -0.2250839116	},
	{ 0.9729399522 , -0.2310581085	},
	{ 0.9715038909 , -0.2370236062	},
	{ 0.9700312531 , -0.2429801801	},
	{ 0.9685220942 , -0.2489276060	},
	{ 0.9669764710 , -0.2548656598	},
	{ 0.9653944416 , -0.2607941181	},
	{ 0.9637760657 , -0.2667127577	},
	{ 0.9621214042 , -0.2726213557	},
	{ 0.9604305193 , -0.2785196896	},
	{ 0.9587034748 , -0.2844075374	},
	{ 0.9569403357 , -0.2902846775	},
	{ 0.9551411682 , -0.2961508885	},
	{ 0.9533060403 , -0.3020059496	},
	{ 0.9514350209 , -0.3078496403	},
	{ 0.9495281805 , -0.3136817406	},
	{ 0.9475855909 , -0.3195020311	},
	{ 0.9456073253 , -0.3253102924	},
	{ 0.9435934581 , -0.3311063060	},
	{ 0.9415440651 , -0.3368898536	},
	{ 0.9394592235 , -0.3426607175	},
	{ 0.9373390118 , -0.3484186805	},
	{ 0.9351835098 , -0.3541635257	},
	{ 0.9329927987 , -0.3598950368	},
	{ 0.9307669610 , -0.3656129980	},
	{ 0.9285060804 , -0.3713171942	},
	{ 0.9262102420 , -0.3770074105	},
	{ 0.9238795324 , -0.3826834326	},
	{ 0.9215140392 , -0.3883450469	},
	{ 0.9191138516 , -0.3939920403	},
	{ 0.9166790598 , -0.3996242001	},
	{ 0.9142097556 , -0.4052413142	},
	{ 0.9117060319 , -0.4108431713	},
	{ 0.9091679830 , -0.4164295603	},
	{ 0.9065957044 , -0.4220002710	},
	{ 0.9039892930 , -0.4275550937	},
	{ 0.9013488469 , -0.4330938191	},
	{ 0.8986744656 , -0.4386162388	},
	{ 0.8959662496 , -0.4441221448	},
	{ 0.8932243011 , -0.4496113299	},
	{ 0.8904487231 , -0.4550835874	},
	{ 0.8876396203 , -0.4605387112	},
	{ 0.8847970983 , -0.4659764960	},
	{ 0.8819212642 , -0.4713967371	},
	{ 0.8790122263 , -0.4767992303	},
	{ 0.8760700941 , -0.4821837723	},
	{ 0.8730949783 , -0.4875501604	},
	{ 0.8700869910 , -0.4928981925	},
	{ 0.8670462454 , -0.4982276672	},
	{ 0.8639728560 , -0.5035383840	},
	{ 0.8608669385 , -0.5088301428	},
	{ 0.8577286099 , -0.5141027444	},
	{ 0.8545579882 , -0.5193559904	},
	{ 0.8513551930 , -0.5245896829	},
	{ 0.8481203447 , -0.5298036249	},
	{ 0.8448535651 , -0.5349976201	},
	{ 0.8415549773 , -0.5401714730	},
	{ 0.8382247054 , -0.5453249887	},
	{ 0.8348628748 , -0.5504579732	},
	{ 0.8314696121 , -0.5555702333	},
	{ 0.8280450451 , -0.5606615764	},
	{ 0.8245893026 , -0.5657318110	},
	{ 0.8211025148 , -0.5707807461	},
	{ 0.8175848130 , -0.5758081917	},
	{ 0.8140363295 , -0.5808139583	},
	{ 0.8104571981 , -0.5857978577	},
	{ 0.8068475534 , -0.5907597021	},
	{ 0.8032075313 , -0.5956993047	},
	{ 0.7995372689 , -0.6006164796	},
	{ 0.7958369044 , -0.6055110416	},
	{ 0.7921065771 , -0.6103828065	},
	{ 0.7883464274 , -0.6152315908	},
	{ 0.7845565970 , -0.6200572120	},
	{ 0.7807372284 , -0.6248594884	},
	{ 0.7768884655 , -0.6296382391	},
	{ 0.7730104532 , -0.6343932844	},
	{ 0.7691033375 , -0.6391244451	},
	{ 0.7651672654 , -0.6438315431	},
	{ 0.7612023853 , -0.6485144012	},
	{ 0.7572088463 , -0.6531728432	},
	{ 0.7531867988 , -0.6578066935	},
	{ 0.7491363943 , -0.6624157778	},
	{ 0.7450577852 , -0.6669999225	},
	{ 0.7409511252 , -0.6715589551	},
	{ 0.7368165687 , -0.6760927038	},
	{ 0.7326542715 , -0.6806009980	},
	{ 0.7284643902 , -0.6850836680	},
	{ 0.7242470827 , -0.6895405450	},
	{ 0.7200025077 , -0.6939714611	},
	{ 0.7157308251 , -0.6983762496	},
	{ 0.7114321955 , -0.7027547447	},
	{ 0.7071067810 , -0.7071067814	},
	{ 0.7027547442 , -0.7114321960	},
	{ 0.6983762492 , -0.7157308255	},
	{ 0.6939714607 , -0.7200025082	},
	{ 0.6895405445 , -0.7242470832	},
	{ 0.6850836675 , -0.7284643907	},
	{ 0.6806009976 , -0.7326542719	},
	{ 0.6760927033 , -0.7368165691	},
	{ 0.6715589546 , -0.7409511256	},
	{ 0.6669999221 , -0.7450577857	},
	{ 0.6624157774 , -0.7491363947	},
	{ 0.6578066931 , -0.7531867993	},
	{ 0.6531728427 , -0.7572088467	},
	{ 0.6485144008 , -0.7612023857	},
	{ 0.6438315426 , -0.7651672658	},
	{ 0.6391244446 , -0.7691033378	},
	{ 0.6343932839 , -0.7730104536	},
	{ 0.6296382387 , -0.7768884659	},
	{ 0.6248594879 , -0.7807372288	},
	{ 0.6200572115 , -0.7845565974	},
	{ 0.6152315903 , -0.7883464278	},
	{ 0.6103828060 , -0.7921065775	},
	{ 0.6055110411 , -0.7958369048	},
	{ 0.6006164791 , -0.7995372693	},
	{ 0.5956993042 , -0.8032075317	},
	{ 0.5907597016 , -0.8068475537	},
	{ 0.5857978572 , -0.8104571984	},
	{ 0.5808139578 , -0.8140363299	},
	{ 0.5758081911 , -0.8175848133	},
	{ 0.5707807456 , -0.8211025152	},
	{ 0.5657318105 , -0.8245893030	},
	{ 0.5606615759 , -0.8280450454	},
	{ 0.5555702327 , -0.8314696125	},
	{ 0.5504579727 , -0.8348628752	},
	{ 0.5453249881 , -0.8382247057	},
	{ 0.5401714724 , -0.8415549776	},
	{ 0.5349976196 , -0.8448535654	},
	{ 0.5298036244 , -0.8481203450	},
	{ 0.5245896824 , -0.8513551933	},
	{ 0.5193559899 , -0.8545579885	},
	{ 0.5141027439 , -0.8577286102	},
	{ 0.5088301422 , -0.8608669388	},
	{ 0.5035383834 , -0.8639728563	},
	{ 0.4982276667 , -0.8670462457	},
	{ 0.4928981919 , -0.8700869913	},
	{ 0.4875501598 , -0.8730949786	},
	{ 0.4821837718 , -0.8760700944	},
	{ 0.4767992298 , -0.8790122266	},
	{ 0.4713967365 , -0.8819212645	},
	{ 0.4659764955 , -0.8847970986	},
	{ 0.4605387106 , -0.8876396206	},
	{ 0.4550835868 , -0.8904487234	},
	{ 0.4496113293 , -0.8932243014	},
	{ 0.4441221443 , -0.8959662499	},
	{ 0.4386162382 , -0.8986744658	},
	{ 0.4330938185 , -0.9013488472	},
	{ 0.4275550931 , -0.9039892933	},
	{ 0.4220002705 , -0.9065957047	},
	{ 0.4164295598 , -0.9091679832	},
	{ 0.4108431707 , -0.9117060322	},
	{ 0.4052413137 , -0.9142097558	},
	{ 0.3996241995 , -0.9166790601	},
	{ 0.3939920397 , -0.9191138518	},
	{ 0.3883450464 , -0.9215140395	},
	{ 0.3826834320 , -0.9238795326	},
	{ 0.3770074099 , -0.9262102423	},
	{ 0.3713171936 , -0.9285060806	},
	{ 0.3656129975 , -0.9307669612	},
	{ 0.3598950362 , -0.9329927990	},
	{ 0.3541635251 , -0.9351835101	},
	{ 0.3484186799 , -0.9373390120	},
	{ 0.3426607170 , -0.9394592237	},
	{ 0.3368898530 , -0.9415440653	},
	{ 0.3311063054 , -0.9435934583	},
	{ 0.3253102918 , -0.9456073255	},
	{ 0.3195020305 , -0.9475855911	},
	{ 0.3136817400 , -0.9495281807	},
	{ 0.3078496397 , -0.9514350211	},
	{ 0.3020059490 , -0.9533060405	},
	{ 0.2961508879 , -0.9551411684	},
	{ 0.2902846769 , -0.9569403358	},
	{ 0.2844075369 , -0.9587034750	},
	{ 0.2785196890 , -0.9604305195	},
	{ 0.2726213551 , -0.9621214044	},
	{ 0.2667127571 , -0.9637760659	},
	{ 0.2607941176 , -0.9653944418	},
	{ 0.2548656592 , -0.9669764711	},
	{ 0.2489276054 , -0.9685220944	},
	{ 0.2429801795 , -0.9700312533	},
	{ 0.2370236056 , -0.9715038911	},
	{ 0.2310581079 , -0.9729399523	},
	{ 0.2250839110 , -0.9743393829	},
	{ 0.2191012398 , -0.9757021301	},
	{ 0.2131103195 , -0.9770281427	},
	{ 0.2071113758 , -0.9783173708	},
	{ 0.2011046345 , -0.9795697658	},
	{ 0.1950903216 , -0.9807852805	},
	{ 0.1890686638 , -0.9819638692	},
	{ 0.1830398876 , -0.9831054875	},
	{ 0.1770042200 , -0.9842100925	},
	{ 0.1709618884 , -0.9852776425	},
	{ 0.1649131201 , -0.9863080973	},
	{ 0.1588581429 , -0.9873014182	},
	{ 0.1527971849 , -0.9882575678	},
	{ 0.1467304741 , -0.9891765100	},
	{ 0.1406582389 , -0.9900582103	},
	{ 0.1345807081 , -0.9909026355	},
	{ 0.1284981104 , -0.9917097537	},
	{ 0.1224106748 , -0.9924795346	},
	{ 0.1163186305 , -0.9932119493	},
	{ 0.1102222069 , -0.9939069700	},
	{ 0.1041216335 , -0.9945645708	},
	{ 0.0980171399 , -0.9951847267	},
	{ 0.0919089561 , -0.9957674145	},
	{ 0.0857973119 , -0.9963126122	},
	{ 0.0796824376 , -0.9968202993	},
	{ 0.0735645632 , -0.9972904567	},
	{ 0.0674439192 , -0.9977230667	},
	{ 0.0613207359 , -0.9981181129	},
	{ 0.0551952439 , -0.9984755806	},
	{ 0.0490676739 , -0.9987954562	},
	{ 0.0429382565 , -0.9990777278	},
	{ 0.0368072225 , -0.9993223846	},
	{ 0.0306748028 , -0.9995294175	},
	{ 0.0245412281 , -0.9996988187	},
	{ 0.0184067295 , -0.9998305818	},
	{ 0.0122715379 , -0.9999247018	},
	{ 0.0061358842 , -0.9999811753	},
	{ -0.0000000004 , -1.0000000000	},
	{ -0.0061358851 , -0.9999811753	},
	{ -0.0122715387 , -0.9999247018	},
	{ -0.0184067303 , -0.9998305818	},
	{ -0.0245412289 , -0.9996988187	},
	{ -0.0306748036 , -0.9995294175	},
	{ -0.0368072234 , -0.9993223846	},
	{ -0.0429382574 , -0.9990777277	},
	{ -0.0490676747 , -0.9987954562	},
	{ -0.0551952448 , -0.9984755806	},
	{ -0.0613207367 , -0.9981181129	},
	{ -0.0674439200 , -0.9977230666	},
	{ -0.0735645640 , -0.9972904566	},
	{ -0.0796824384 , -0.9968202993	},
	{ -0.0857973128 , -0.9963126121	},
	{ -0.0919089569 , -0.9957674144	},
	{ -0.0980171408 , -0.9951847266	},
	{ -0.1041216343 , -0.9945645707	},
	{ -0.1102222077 , -0.9939069700	},
	{ -0.1163186313 , -0.9932119492	},
	{ -0.1224106756 , -0.9924795345	},
	{ -0.1284981112 , -0.9917097536	},
	{ -0.1345807089 , -0.9909026354	},
	{ -0.1406582398 , -0.9900582102	},
	{ -0.1467304749 , -0.9891765099	},
	{ -0.1527971857 , -0.9882575677	},
	{ -0.1588581438 , -0.9873014181	},
	{ -0.1649131209 , -0.9863080972	},
	{ -0.1709618892 , -0.9852776423	},
	{ -0.1770042208 , -0.9842100923	},
	{ -0.1830398884 , -0.9831054874	},
	{ -0.1890686646 , -0.9819638690	},
	{ -0.1950903224 , -0.9807852803	},
	{ -0.2011046353 , -0.9795697656	},
	{ -0.2071113766 , -0.9783173706	},
	{ -0.2131103203 , -0.9770281426	},
	{ -0.2191012406 , -0.9757021299	},
	{ -0.2250839118 , -0.9743393827	},
	{ -0.2310581087 , -0.9729399521	},
	{ -0.2370236064 , -0.9715038909	},
	{ -0.2429801803 , -0.9700312531	},
	{ -0.2489276062 , -0.9685220942	},
	{ -0.2548656600 , -0.9669764709	},
	{ -0.2607941183 , -0.9653944416	},
	{ -0.2667127579 , -0.9637760657	},
	{ -0.2726213559 , -0.9621214041	},
	{ -0.2785196898 , -0.9604305193	},
	{ -0.2844075376 , -0.9587034748	},
	{ -0.2902846777 , -0.9569403356	},
	{ -0.2961508887 , -0.9551411682	},
	{ -0.3020059497 , -0.9533060402	},
	{ -0.3078496405 , -0.9514350208	},
	{ -0.3136817408 , -0.9495281805	},
	{ -0.3195020312 , -0.9475855909	},
	{ -0.3253102926 , -0.9456073252	},
	{ -0.3311063062 , -0.9435934580	},
	{ -0.3368898538 , -0.9415440650	},
	{ -0.3426607177 , -0.9394592234	},
	{ -0.3484186807 , -0.9373390118	},
	{ -0.3541635258 , -0.9351835098	},
	{ -0.3598950370 , -0.9329927987	},
	{ -0.3656129982 , -0.9307669609	},
	{ -0.3713171944 , -0.9285060803	},
	{ -0.3770074106 , -0.9262102420	},
	{ -0.3826834328 , -0.9238795323	},
	{ -0.3883450471 , -0.9215140392	},
	{ -0.3939920405 , -0.9191138515	},
	{ -0.3996242003 , -0.9166790597	},
	{ -0.4052413144 , -0.9142097555	},
	{ -0.4108431715 , -0.9117060318	},
	{ -0.4164295605 , -0.9091679829	},
	{ -0.4220002712 , -0.9065957043	},
	{ -0.4275550939 , -0.9039892929	},
	{ -0.4330938193 , -0.9013488468	},
	{ -0.4386162390 , -0.8986744655	},
	{ -0.4441221450 , -0.8959662495	},
	{ -0.4496113301 , -0.8932243010	},
	{ -0.4550835875 , -0.8904487230	},
	{ -0.4605387114 , -0.8876396202	},
	{ -0.4659764962 , -0.8847970982	},
	{ -0.4713967372 , -0.8819212641	},
	{ -0.4767992305 , -0.8790122262	},
	{ -0.4821837725 , -0.8760700940	},
	{ -0.4875501606 , -0.8730949782	},
	{ -0.4928981926 , -0.8700869909	},
	{ -0.4982276674 , -0.8670462453	},
	{ -0.5035383841 , -0.8639728559	},
	{ -0.5088301430 , -0.8608669384	},
	{ -0.5141027446 , -0.8577286098	},
	{ -0.5193559906 , -0.8545579881	},
	{ -0.5245896831 , -0.8513551929	},
	{ -0.5298036251 , -0.8481203445	},
	{ -0.5349976203 , -0.8448535650	},
	{ -0.5401714731 , -0.8415549772	},
	{ -0.5453249888 , -0.8382247053	},
	{ -0.5504579733 , -0.8348628747	},
	{ -0.5555702334 , -0.8314696120	},
	{ -0.5606615766 , -0.8280450450	},
	{ -0.5657318112 , -0.8245893025	},
	{ -0.5707807463 , -0.8211025147	},
	{ -0.5758081918 , -0.8175848129	},
	{ -0.5808139585 , -0.8140363294	},
	{ -0.5857978579 , -0.8104571980	},
	{ -0.5907597023 , -0.8068475533	},
	{ -0.5956993049 , -0.8032075312	},
	{ -0.6006164798 , -0.7995372688	},
	{ -0.6055110418 , -0.7958369043	},
	{ -0.6103828067 , -0.7921065770	},
	{ -0.6152315910 , -0.7883464273	},
	{ -0.6200572122 , -0.7845565968	},
	{ -0.6248594885 , -0.7807372283	},
	{ -0.6296382393 , -0.7768884654	},
	{ -0.6343932846 , -0.7730104530	},
	{ -0.6391244452 , -0.7691033373	},
	{ -0.6438315433 , -0.7651672653	},
	{ -0.6485144014 , -0.7612023852	},
	{ -0.6531728433 , -0.7572088462	},
	{ -0.6578066937 , -0.7531867987	},
	{ -0.6624157780 , -0.7491363942	},
	{ -0.6669999227 , -0.7450577851	},
	{ -0.6715589552 , -0.7409511250	},
	{ -0.6760927039 , -0.7368165685	},
	{ -0.6806009982 , -0.7326542713	},
	{ -0.6850836681 , -0.7284643901	},
	{ -0.6895405451 , -0.7242470826	},
	{ -0.6939714613 , -0.7200025076	},
	{ -0.6983762498 , -0.7157308249	},
	{ -0.7027547448 , -0.7114321954	},
	{ -0.7071067815 , -0.7071067808	},
	{ -0.7114321961 , -0.7027547441	},
	{ -0.7157308256 , -0.6983762490	},
	{ -0.7200025083 , -0.6939714605	},
	{ -0.7242470833 , -0.6895405444	},
	{ -0.7284643908 , -0.6850836674	},
	{ -0.7326542720 , -0.6806009974	},
	{ -0.7368165692 , -0.6760927032	},
	{ -0.7409511257 , -0.6715589545	},
	{ -0.7450577858 , -0.6669999219	},
	{ -0.7491363949 , -0.6624157772	},
	{ -0.7531867994 , -0.6578066929	},
	{ -0.7572088468 , -0.6531728426	},
	{ -0.7612023858 , -0.6485144006	},
	{ -0.7651672660 , -0.6438315425	},
	{ -0.7691033380 , -0.6391244445	},
	{ -0.7730104537 , -0.6343932838	},
	{ -0.7768884660 , -0.6296382385	},
	{ -0.7807372289 , -0.6248594877	},
	{ -0.7845565975 , -0.6200572113	},
	{ -0.7883464280 , -0.6152315902	},
	{ -0.7921065776 , -0.6103828059	},
	{ -0.7958369049 , -0.6055110410	},
	{ -0.7995372694 , -0.6006164790	},
	{ -0.8032075318 , -0.5956993041	},
	{ -0.8068475539 , -0.5907597014	},
	{ -0.8104571986 , -0.5857978570	},
	{ -0.8140363300 , -0.5808139577	},
	{ -0.8175848135 , -0.5758081910	},
	{ -0.8211025153 , -0.5707807454	},
	{ -0.8245893031 , -0.5657318103	},
	{ -0.8280450456 , -0.5606615758	},
	{ -0.8314696126 , -0.5555702326	},
	{ -0.8348628753 , -0.5504579725	},
	{ -0.8382247058 , -0.5453249880	},
	{ -0.8415549777 , -0.5401714723	},
	{ -0.8448535655 , -0.5349976194	},
	{ -0.8481203451 , -0.5298036242	},
	{ -0.8513551934 , -0.5245896822	},
	{ -0.8545579886 , -0.5193559897	},
	{ -0.8577286103 , -0.5141027437	},
	{ -0.8608669389 , -0.5088301421	},
	{ -0.8639728564 , -0.5035383833	},
	{ -0.8670462458 , -0.4982276665	},
	{ -0.8700869914 , -0.4928981918	},
	{ -0.8730949787 , -0.4875501597	},
	{ -0.8760700945 , -0.4821837716	},
	{ -0.8790122267 , -0.4767992296	},
	{ -0.8819212646 , -0.4713967363	},
	{ -0.8847970987 , -0.4659764953	},
	{ -0.8876396207 , -0.4605387105	},
	{ -0.8904487235 , -0.4550835866	},
	{ -0.8932243014 , -0.4496113292	},
	{ -0.8959662500 , -0.4441221441	},
	{ -0.8986744659 , -0.4386162380	},
	{ -0.9013488473 , -0.4330938184	},
	{ -0.9039892934 , -0.4275550929	},
	{ -0.9065957048 , -0.4220002703	},
	{ -0.9091679833 , -0.4164295596	},
	{ -0.9117060322 , -0.4108431705	},
	{ -0.9142097559 , -0.4052413135	},
	{ -0.9166790601 , -0.3996241993	},
	{ -0.9191138519 , -0.3939920395	},
	{ -0.9215140396 , -0.3883450462	},
	{ -0.9238795327 , -0.3826834318	},
	{ -0.9262102424 , -0.3770074097	},
	{ -0.9285060807 , -0.3713171934	},
	{ -0.9307669613 , -0.3656129973	},
	{ -0.9329927990 , -0.3598950360	},
	{ -0.9351835101 , -0.3541635249	},
	{ -0.9373390121 , -0.3484186797	},
	{ -0.9394592238 , -0.3426607168	},
	{ -0.9415440654 , -0.3368898529	},
	{ -0.9435934584 , -0.3311063052	},
	{ -0.9456073256 , -0.3253102916	},
	{ -0.9475855912 , -0.3195020303	},
	{ -0.9495281808 , -0.3136817399	},
	{ -0.9514350211 , -0.3078496395	},
	{ -0.9533060405 , -0.3020059488	},
	{ -0.9551411685 , -0.2961508877	},
	{ -0.9569403359 , -0.2902846767	},
	{ -0.9587034751 , -0.2844075367	},
	{ -0.9604305196 , -0.2785196888	},
	{ -0.9621214044 , -0.2726213549	},
	{ -0.9637760660 , -0.2667127569	},
	{ -0.9653944418 , -0.2607941174	},
	{ -0.9669764712 , -0.2548656590	},
	{ -0.9685220944 , -0.2489276052	},
	{ -0.9700312533 , -0.2429801793	},
	{ -0.9715038911 , -0.2370236054	},
	{ -0.9729399523 , -0.2310581077	},
	{ -0.9743393829 , -0.2250839108	},
	{ -0.9757021302 , -0.2191012396	},
	{ -0.9770281428 , -0.2131103193	},
	{ -0.9783173708 , -0.2071113756	},
	{ -0.9795697658 , -0.2011046343	},
	{ -0.9807852805 , -0.1950903214	},
	{ -0.9819638692 , -0.1890686636	},
	{ -0.9831054875 , -0.1830398874	},
	{ -0.9842100925 , -0.1770042198	},
	{ -0.9852776425 , -0.1709618882	},
	{ -0.9863080973 , -0.1649131199	},
	{ -0.9873014183 , -0.1588581427	},
	{ -0.9882575678 , -0.1527971847	},
	{ -0.9891765101 , -0.1467304739	},
	{ -0.9900582103 , -0.1406582387	},
	{ -0.9909026355 , -0.1345807079	},
	{ -0.9917097537 , -0.1284981102	},
	{ -0.9924795347 , -0.1224106746	},
	{ -0.9932119493 , -0.1163186303	},
	{ -0.9939069701 , -0.1102222067	},
	{ -0.9945645708 , -0.1041216333	},
	{ -0.9951847267 , -0.0980171397	},
	{ -0.9957674145 , -0.0919089559	},
	{ -0.9963126122 , -0.0857973117	},
	{ -0.9968202993 , -0.0796824374	},
	{ -0.9972904567 , -0.0735645630	},
	{ -0.9977230667 , -0.0674439190	},
	{ -0.9981181129 , -0.0613207357	},
	{ -0.9984755806 , -0.0551952437	},
	{ -0.9987954562 , -0.0490676737	},
	{ -0.9990777278 , -0.0429382563	},
	{ -0.9993223846 , -0.0368072223	},
	{ -0.9995294175 , -0.0306748026	},
	{ -0.9996988187 , -0.0245412279	},
	{ -0.9998305818 , -0.0184067293	},
	{ -0.9999247018 , -0.0122715377	},
	{ -0.9999811753 , -0.0061358840	}
};
const Complex *w = FFT_W;
//================================================
//#endif

unsigned char FFT(Complex *d,int m)
{
#ifndef __EXTERN_W__
	static Complex *w;
	static int mw = 0;
	float arg, w_real, w_imag, wr_real, wr_imag, wtemp;
#endif
	static int n = 1;
	Complex temp, tmp1, tmp2;
	Complex *di, *dip, *dj, *wp;
	int i, j, k, l, le, wi;
#ifndef __EXTERN_W__
	if(m != mw)
	{
		if(mw != 0)
			free(w);
		mw = m;
		if(m == 0)
			return 0;
		n = 1 << m;
		le = n >> 1;
		w = (Complex*)calloc(le - 1,sizeof(Complex));
		if(!w)
			return 0;
		arg = 4.0 * atan(1.0) / le;
		wr_real = w_real = cos(arg);
		wr_imag = w_imag = -sin(arg);
		dj = w;
		for(j = 1; j < le; j++)
		{
			dj->real = (float)wr_real;
			dj->imag = (float)wr_imag;
			dj++;
			wtemp = wr_real * w_real - wr_imag * w_imag;
			wr_imag = wr_real * w_imag + wr_imag * w_real;
			wr_real = wtemp;
		}
	}
#else
	n = 1 << m;
#endif
	le = n;
	wi = 1;
	for(l = 0; l < m; l++)
	{
		le >>= 1;
		for(i = 0; i < n; i += (le << 1))
		{
			di = d + i;
			dip = di + le;
			temp.real = (di->real + dip->real);
			temp.imag = (di->imag + dip->imag);
			dip->real = (di->real - dip->real);
			dip->imag = (di->imag - dip->imag);
			*di = temp;                       
		}
		wp = (Complex*)w + wi - 1;
		for(j = 1; j < le; j++)
		{
			tmp1 = *wp;
			for(i = j; i < n; i += (le << 1))
			{
				di = d + i;
				dip = di + le;
				temp.real = (di->real + dip->real);
				temp.imag = (di->imag + dip->imag);
				tmp2.real = (di->real - dip->real);
				tmp2.imag = (di->imag - dip->imag);
				dip->real = (tmp2.real * tmp1.real - tmp2.imag * tmp1.imag);
				dip->imag = (tmp2.real * tmp1.imag + tmp2.imag * tmp1.real);
				*di = temp;
			}
			wp += wi;
		}
		wi <<= 1;
	}
	
	for(i = 0; i < n; i++)
	{
		j = 0;
		for(k = 0; k < m; k++)
			j = (j << 1) | ((i >> k) & 1);
		if(i < j)
		{
			di = d + i;
			dj = d + j;
			temp = *dj;
			*dj = *di;
			*di = temp;
		}
	}
	return 1;
}
void Sin_table(int N)
{
	int i;
	double pai=3.141592654;
	double a;
	double b;
	for(i=1;i<N;i++)
	{
		a=sin(pai*i/(N)+pai/2);
		b=cos(pai*i/(N)+pai/2);
		printf("	{ %.10lf , %.10lf	},\r\n",a,b);
	}
	
	
}

void AmpSpectrum(Complex *pData,int m,float* pDCAmp,float* pDistortion)
{
   // Amp = Abs / (1.414213562 * N)
	int i;
	int N = 1 << (m - 1);
	int N2 = 1 << m;
	float BasePower;     //exactly BasePower*2*N*N;
	float SyntPower = 0; //exactly SyntPower*2*N*N;
	float ModelSquare;
	*pDCAmp = sqrt(pData[0].real * pData[0].real + pData[0].imag * pData[0].imag) / (N << 1);
	BasePower = pData[1].real * pData[1].real + pData[1].imag * pData[1].imag;
	pData[N2 - 1].real = sqrt(BasePower);
	pData[N2 - 1].imag = asin(pData[N2 - 1].imag / pData[N2 - 1].real);
	pData[N2 - 1].real /= N;
	for(i = 2; i < N; i++)
	{
		ModelSquare = pData[i].real * pData[i].real + pData[i].imag * pData[i].imag;
		pData[N2 - i].real = sqrt(ModelSquare);
		pData[N2 - i].imag = asin(pData[N2-i].imag/pData[N2-i].real);
		pData[N2 - i].real /= N;
		SyntPower += ModelSquare;
	}
	*pDistortion = sqrt(SyntPower / BasePower);
}


